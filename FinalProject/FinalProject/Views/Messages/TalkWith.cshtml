@model FinalProject.Models.ViewModels.MessagesContactsViewModel
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
<!----------------------------------------------------------------------Control Panel Navigation Links -->
<div id="navCPanel" class="section brown lighten-5">
    <div class="container" style="padding-bottom:15px;">
        <div class="container">
            <div class="row">
                <div class="col l4 m6 s12 center-align" style="margin-top:10px;">
                    <a href="#" class="brown-text text-darken-4" style="font-size:20px;">
                        <i class="material-icons left small">schedule</i>Schedule
                    </a>
                </div>
                <div class="col l4 m6 s12 center-align" style="margin-top:10px;">
                    <a href="#" class="brown-text text-darken-4" style="font-size:20px;">
                        <i class="material-icons left small">mail_outline</i>Messages
                    </a>
                </div>
                <div class="col l4 m6 s12 center-align" style="margin-top:10px;">
                    <a href="#" class="brown-text text-darken-4" style="font-size:20px;">
                        <i class="material-icons left small">developer_board</i>Statistics
                    </a>
                </div>
                <div class="col l4 m6 s12 center-align" style="margin-top:10px;">
                    <a href="#" class="brown-text text-darken-4" style="font-size:20px;">
                        <i class="material-icons left small">history</i>Lessons History
                    </a>
                </div>
                <div class="col l4 m6 s12 center-align" style="margin-top:10px;">
                    <a href="#" class="brown-text text-darken-4" style="font-size:20px;">
                        <i class="material-icons left small">person</i>Edit Profile
                    </a>
                </div>
                <div class="col l4 m6 s12 center-align" style="margin-top:10px;">
                    <a href="#" class="brown-text text-darken-4" style="font-size:20px;">
                        <i class="material-icons left small">group_work</i>Manage Groups
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
<!----------------------------------------------------------------------Edit Profile-->
<div class="section grey lighten-5">
    <div class="container">
        <h4 class="center-align">Messages</h4>
        <div class="row">
            <!------------------------------------------------------------------Student List-->
            <div class="studentsList col s12 l4">
                <ul style="position: relative; top:-15px;">
                    @if (Model.MsgGroup == null)
                    {
                        <p>No Contacts Yet</p>
                    }
                    else
                    {
                        @foreach (var item in Model.MsgGroup)
                        {
                            <li class="row studentCardHeight grey lighten-4 studentListItem" style="height:42px;">
                                <div class="col s3 studentCardHeight">
                                    <img src="~/@item.OtherUser.PicPath" alt="" class="studentCardImg">
                                </div>
                                <div class="col s9 studentCardHeight">
                                    <span class="new badge" style="position:relative; left:0px;top:20px;">@item.numOfUnreadMsgs</span>
                                    <a asp-controller="Messages" asp-action="TalkWith" asp-route-Id="@item.OtherUser.Id" class="studentCardText">@(item.OtherUser.FirstName + " " + item.OtherUser.LastName)</a>
                                </div>
                                <div class="col s12 grey lighten-1"></div>
                            </li>
                        }
                    }
                </ul>
            </div>
            <!------------------------------------------------------------------Messages-->
            <div class="col s12 l8" style="margin-bottom:0px;">
                <div style="">
                    <ul style="position: relative; max-height:450px; overflow-x:hidden; overflow-y:visible;">
                        @if (Model.OtherId != null)
                        {
                            @foreach (var msg in Model.Messages)
                            {
                                <li class="row" style="margin-bottom:0px;">
                                    <div class="col s12">
                                        <p>
                                            <b>@(msg.Sender.FirstName + " " + msg.Sender.LastName)- @msg.Date.ToString()</b>
                                            <br />
                                            @msg.Content
                                        </p>
                                    </div>
                                </li>
                            }
                        }
                    </ul>
                    <div class="row">
                        @if (Model.OtherId != null)
                        {
                            <form asp-controller="Messages" asp-action="SendMessage">
                                <div class="input-field col s12">

                                    <textarea id="textarea1" asp-for="Message" class="materialize-textarea"></textarea>
                                    <input type="hidden" value="@Model.OtherId" asp-for="OtherId" />
                                    <label for="textarea1">Write a message:</label>
                                    <div class="center-align">
                                        <input type="submit" class="waves-effect waves-light btn" />
                                    </div>
                            </form>
                        }
                    </div>
                    </div>
                </div>
            </div> <!--end right column-->
        </div> <!-- row containing columns-->
    </div>
</div>
